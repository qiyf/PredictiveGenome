# This is a branch program to calculate the contact maps based on the trajectories of the MD simulation

To visualize the structure colored by chromatin states, VMD scripts for individual chromosomes are provided, and can be generated by using the code that is provided at `./src/VMD/VMDmain.py`, where the input are also **[Celltype]** and **chromosome id array]**.  
```
python VMDmain.py [-C Celltype] [-c chromosome_id_array]
```
The manual would be available by executing:  
```
python VMDmain.py -h
```

After generating the VMD scripts and in order to visualize the structure, open the VMD software (which can be downloaded from [http://www.ks.uiuc.edu/Research/vmd/](http://www.ks.uiuc.edu/Research/vmd/)) and click under `Extension/TK Console` option, go to the folder: `./src/VMD/VMDScript/`, find the VMD script for the corresponding chromosome. E.g., for Gm12878, chromosome 1, execute the following command in the VMD console:
```
play VMDColor_Gm12878_chr1.vmd
```
where a chromosome structure colored by chromatin states should be appearing in the display window. Then find and go to the path where the simulated .dcd file (trajectory) is located. E.g., for Gm12878, chromosome 1, 1st parallel running, it should be located in the folder `/runSimulation/run_folder/Gm12878/chr1/run00/`, and execute the following command in the VMD console:
```
animate read dcd DUMP_FILE.dcd 
```
where the trajectory would be loaded and appearing in the display window.
